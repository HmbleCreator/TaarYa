<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaarYa ‚Äî Intelligent Astronomy Research Assistant</title>
    <meta name="description" content="TaarYa: AI-powered astronomy research assistant with Gaia catalog search, paper discovery, and knowledge graph exploration.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <!-- Background stars effect -->
    <div class="stars-bg" id="starsBg"></div>
    
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-brand">
            <span class="nav-icon">‚ú¶</span>
            <span class="nav-title">TaarYa</span>
            <span class="nav-subtitle">Astronomy Intelligence</span>
        </div>
        <div class="nav-links">
            <button class="nav-btn active" data-tab="chat" id="tabChat">
                <span class="btn-icon">üí¨</span> Ask
            </button>
            <button class="nav-btn" data-tab="explore" id="tabExplore">
                <span class="btn-icon">üî≠</span> Explore
            </button>
            <button class="nav-btn" data-tab="stats" id="tabStats">
                <span class="btn-icon">üìä</span> System
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        
        <!-- CHAT TAB -->
        <section class="tab-content active" id="panelChat">
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message assistant">
                        <div class="message-avatar">‚ú¶</div>
                        <div class="message-content">
                            <div class="message-text">
                                <strong>Welcome to TaarYa!</strong> I'm your astronomy research assistant.
                                I can search the <strong>Gaia DR3 catalog</strong> (1,000 stars loaded), 
                                explore research papers, and traverse the knowledge graph.
                                <br><br>
                                Try asking me something like:
                                <ul class="suggestions">
                                    <li onclick="sendSuggestion(this)">Show me bright stars near RA=45, Dec=0.5</li>
                                    <li onclick="sendSuggestion(this)">How many stars are within 1 degree of RA=45, Dec=0?</li>
                                    <li onclick="sendSuggestion(this)">Look up star 33328946452480</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="chat-input-area">
                    <div class="chat-input-wrapper">
                        <input type="text" id="chatInput" 
                               placeholder="Ask about stars, coordinates, or research papers..."
                               autocomplete="off">
                        <button id="chatSend" onclick="sendMessage()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- EXPLORE TAB -->
        <section class="tab-content" id="panelExplore">
            <div class="explore-grid">
                <!-- Spatial Search Card -->
                <div class="card search-card">
                    <h2 class="card-title">
                        <span class="card-icon">üåå</span> Spatial Search
                    </h2>
                    <p class="card-desc">Find stars by sky coordinates using Q3C spatial indexing</p>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>RA (deg)</label>
                            <input type="number" id="searchRA" value="45.0" step="0.1" min="0" max="360">
                        </div>
                        <div class="form-group">
                            <label>Dec (deg)</label>
                            <input type="number" id="searchDec" value="0.5" step="0.1" min="-90" max="90">
                        </div>
                        <div class="form-group">
                            <label>Radius (deg)</label>
                            <input type="number" id="searchRadius" value="0.5" step="0.1" min="0.01" max="10">
                        </div>
                        <div class="form-group">
                            <label>Max G-mag</label>
                            <input type="number" id="searchMag" value="" step="0.5" placeholder="Any">
                        </div>
                    </div>
                    <button class="btn-primary" onclick="runConeSearch()">
                        Search Stars
                    </button>
                </div>

                <!-- Star Lookup Card -->
                <div class="card lookup-card">
                    <h2 class="card-title">
                        <span class="card-icon">‚≠ê</span> Star Lookup
                    </h2>
                    <p class="card-desc">Get detailed info on a specific Gaia source</p>
                    <div class="form-group" style="margin-bottom: 16px;">
                        <label>Source ID</label>
                        <input type="text" id="lookupId" placeholder="e.g. 33328946452480">
                    </div>
                    <button class="btn-primary" onclick="runStarLookup()">
                        Look Up
                    </button>
                    <div id="lookupResult" class="result-box"></div>
                </div>

                <!-- Region Stats Card -->
                <div class="card count-card">
                    <h2 class="card-title">
                        <span class="card-icon">üìê</span> Region Density
                    </h2>
                    <p class="card-desc">Count stars in a sky region</p>
                    <div id="regionCount" class="big-stat">‚Äî</div>
                    <p class="stat-label">stars in current search region</p>
                </div>
            </div>

            <!-- Results Table -->
            <div class="card results-card" id="resultsCard" style="display: none;">
                <div class="results-header">
                    <h2 class="card-title">
                        <span class="card-icon">üìã</span> Search Results
                    </h2>
                    <span class="results-count" id="resultsCount"></span>
                </div>
                <div class="table-wrapper">
                    <table id="resultsTable">
                        <thead>
                            <tr>
                                <th>Source ID</th>
                                <th>RA (¬∞)</th>
                                <th>Dec (¬∞)</th>
                                <th>G mag</th>
                                <th>BP-RP</th>
                                <th>Parallax (mas)</th>
                                <th>Distance (¬∞)</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="resultsBody"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- STATS TAB -->
        <section class="tab-content" id="panelStats">
            <div class="stats-grid">
                <div class="card stat-card postgres-card">
                    <div class="stat-icon">üêò</div>
                    <h3>PostgreSQL + Q3C</h3>
                    <div class="stat-value" id="statPostgres">‚Äî</div>
                    <p class="stat-detail">Total stars in catalog</p>
                    <div class="stat-status connected" id="statPostgresStatus">Connected</div>
                </div>
                <div class="card stat-card qdrant-card">
                    <div class="stat-icon">üß†</div>
                    <h3>Qdrant</h3>
                    <div class="stat-value" id="statQdrant">‚Äî</div>
                    <p class="stat-detail">Paper embeddings</p>
                    <div class="stat-status" id="statQdrantStatus">Checking...</div>
                </div>
                <div class="card stat-card neo4j-card">
                    <div class="stat-icon">üï∏Ô∏è</div>
                    <h3>Neo4j</h3>
                    <div class="stat-value" id="statNeo4j">‚Äî</div>
                    <p class="stat-detail">Knowledge graph nodes</p>
                    <div class="stat-status" id="statNeo4jStatus">Checking...</div>
                </div>
            </div>
            <div class="card arch-card">
                <h2 class="card-title"><span class="card-icon">üèóÔ∏è</span> Architecture</h2>
                <div class="arch-flow">
                    <div class="arch-node query-node">User Query</div>
                    <div class="arch-arrow">‚Üí</div>
                    <div class="arch-node agent-node">TaarYa Agent<br><small>LangChain + Tools</small></div>
                    <div class="arch-arrow">‚Üí</div>
                    <div class="arch-backends">
                        <div class="arch-node db-node">PostgreSQL<br><small>Q3C Spatial</small></div>
                        <div class="arch-node db-node">Qdrant<br><small>Vector Search</small></div>
                        <div class="arch-node db-node">Neo4j<br><small>Knowledge Graph</small></div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script src="/static/app.js"></script>
</body>
</html>
